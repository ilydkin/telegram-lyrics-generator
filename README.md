# 2023.02_Telegram lyrics generator (Voluspa)
![A beautiful AI Lady should be here](https://user-images.githubusercontent.com/115424463/266305457-0d3d78cc-6fda-4816-b645-8ae4e46da1f2.jpeg)
A small project of making a Telegram chat service on the basis of a neural network 
that was trained on Manowar lyrics to produce 'predictions' in accord with the questions asked

Original concept is borrowed from: https://github.com/dlebech/lyrics-generator/

Actions taken and features introduced in this project:
 - Preparation of feed for a model on the basis of Manowar songs, fetched from https://www.azlyrics.com/
 - Training the model on the resulting dataset
 - Embedding the lyrics-generator script into the Telegram 'echo bot'
 - Deployment of the service in YandexCloud

# Telegram bot
The bot is named "Voluspa" (which refers to a poem about a prophetic witch from the Poetic Edda).
The choice of the bot's name was informed by the specifically elevated style of texts generated by the Manowar-imitating model.
Voluspa lives here: http://t.me/MN_o_WR_bot

# Feed preparation
`Feed_Preparation.ipynb` contains commands to fetch, parse, normalize Manowar lyrics and make a feed for the model. 
Herewith file `data/songdata.csv` is the resulting feed, whereas `export/model.h5` is a model, respectively trained on its basis.     
To cook your own feed and make it digestible for the model you may wish to follow the recipe:
  1. The code expects an input dataset to be stored as `data/songdata.csv` by default. 
  2. The file should be in CSV format with the following columns (case sensitive):
     - `artist`(A string, e.g. "The Beatles")
     - `text`(A string with the entire lyrics for one song, including newlines)

# Embeddings
- Download `glove.6B.50d.txt` file from:http://nlp.stanford.edu/data/glove.6B.zipin and put it in the subdirectory `data/`.
- Or create your own embedding: make `songdata.csv` file from above and then run:
```shell
python -m lyrics.embedding --name-suffix _myembedding
```
- This will create `word2vec_myembedding.model` and `word2vec_myembedding.txt` files in the default subdirectory `data/`.

# Training the model
To train your own model run one of the following:
```shell
python -m lyrics.train --early-stopping-patience 50 --artists '*'
python -m lyrics.train --embedding-file ./word2vec_myembedding.txt
```
Check `python -m lyrics.train -h` for other options
Check `lyrics/config.py` for training configuration 

# Run main()
To make it work you will have to specify your own telegram token in tg_token

# Install dependencies
Requires Python 3.7+.
```shell
pip install -r requirements.txt
```
